<div id="content">
    <h3>Annotation {{model.audioEventId}}</h3>

    <div class="row">
        <div class="col-md-12">
            <div class="library-single"
                 data-ng-style="{width:annotation.converters.conversions.enforcedImageWidth + 100}">
                <div class="library-spectrogram">
                    <img data-ng-src="{{annotation.media.availableImageFormats.png.url}}"
                         data-ng-style="{width: annotation.converters.conversions.enforcedImageWidth, height: annotation.converters.conversions.enforcedImageHeight}">
                    <grid-lines configuration="annotation.gridConfig" class="library-spectrogram-grid"></grid-lines>
                    <div class="library-spectrogram-bounds"
                         data-ng-style="{top: annotation.bounds.top, left: annotation.bounds.left, width: annotation.bounds.width, height: annotation.bounds.height}"></div>
                </div>
                <audio id="annoSingleAudio{{$index}}" controls
                       data-ng-style="{width:annotation.converters.conversions.enforcedImageWidth}">
                    <source data-ng-repeat="resource in annotation.media.availableAudioFormats"
                            data-ng-src="{{resource.url}}" src=""
                            type="{{resource.mimeType}}">
                    Your browser does not support the audio element.
                </audio>

            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <ul class="pager">
                <li class="previous" data-ng-show="annotation.paging.prevEvent.link">
                    <a data-ng-href="{{annotation.paging.prevEvent.link}}">&larr; Previous</a>
                </li>
                <li class="next" data-ng-show="annotation.paging.nextEvent.link">
                    <a data-ng-href="{{annotation.paging.nextEvent.link}}">Next &rarr;</a>
                </li>
            </ul>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="library-single-info panel panel-default">
                <div class="panel-heading clearfix">
                    <h3 class="panel-title pull-left">Details</h3>
                </div>
                <div class="panel-body">
                    <div class="list-group">
                        <a data-ng-repeat="tag in annotation.tags"
                           data-ng-href="{{$parent.createFilterUrl({'tagsPartial': tag.text})}}"
                           class="list-group-item" title="Tag.">
                            <span class="glyphicon glyphicon-tags"></span>&nbsp;
                            <span class="badge">{{tag.typeOfTag.replace('_',' ')}}</span>
                            <span class="badge" data-ng-show="tag.retired">retired</span>
                            <span class="badge" data-ng-show="tag.isTaxanomic">taxonomic</span>
                            {{tag.text}} (ID {{tag.id}})
                        </a>
                        <a data-ng-show="annotation.isReference"
                           data-ng-href="{{$parent.createFilterUrl({'reference': annotation.isReference})}}"
                           class="list-group-item" title="Reference tag.">
                            <span class="glyphicon glyphicon-book"></span>&nbsp;
                            Reference Tag
                        </a>
                        <a data-ng-href="{{annotation.urls.listen}}" class="list-group-item" title="Start date.">
                            <span class="glyphicon glyphicon-record"></span>&nbsp;
                            Created {{annotation.audioEventStartDate | date: 'medium'}}
                        </a>
                        <a data-ng-href="{{annotation.urls.listen}}" class="list-group-item" title="Duration.">
                            <span class="glyphicon glyphicon-time"></span>&nbsp;
                            {{annotation.annotationDurationRounded}} seconds duration
                        </a>
                        <a data-ng-repeat="project in annotation.projects"
                           data-ng-href="{{$parent.createProjectUrl(project.id)}}" class="list-group-item"
                           title="Project name.">
                            <span class="glyphicon glyphicon-home"></span>&nbsp;
                            Project: {{project.name}}
                        </a>
                        <a data-ng-href="{{annotation.urls.site}}" class="list-group-item" title="Site name.">
                            <span class="glyphicon glyphicon-music"></span>&nbsp;
                            Site: {{annotation.siteName}}
                        </a>
                        <a data-ng-href="{{annotation.urls.audioRecording}}" class="list-group-item" title="Site name.">
                            <span class="glyphicon glyphicon-map-marker"></span>&nbsp;
                            Audio recording: {{annotation.audioRecordingId}}
                        </a>
                        <a data-ng-href="{{annotation.urls.user}}" class="list-group-item" title="User.">
                            <span class="glyphicon glyphicon-user"></span>&nbsp;
                            {{annotation.ownerName }}
                        </a>
                        <a data-ng-href="{{annotation.urls.similar}}" class="list-group-item"
                           title="Find similar annotations.">
                            <span class="glyphicon glyphicon-search"></span>&nbsp;
                            Find Similar
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="library-single-info panel panel-default">
                <div class="panel-heading clearfix">
                    <h3 class="panel-title pull-left"><span class="glyphicon glyphicon-comment"></span>&nbsp;Comments
                    </h3>
                </div>
                <div class="panel-body">
                    <ul class="media-list">
                        <li class="media">
                            <a class="pull-left" href="#">
                                <img class="media-object" src="" alt="">
                            </a>

                            <div class="media-body">
                                <h4 class="media-heading">
                                    {{profile.userName}}
                                    <small title="now">now</small>
                                </h4>

                                <form role="form">
                                    <div class="form-group" ng-class="{'has-error': newComment.errors.length > 0}">
                                        <textarea class="form-control"
                                                  placeholder="Add a comment / Continue the discussion"
                                                  style="width:90%" id="addAnnotationComment"
                                                  ng-model="newComment.text"></textarea>
                                        <span class="help-block" ng-show="newComment.errors.length > 0"
                                              ng-repeat="error in newComment.errors">{{error}}</span>
                                    </div>
                                    <button type="submit" class="btn btn-default" ng-click="createComment()">Post
                                    </button>
                                </form>

                            </div>
                        </li>
                    </ul>
                    <ul class="media-list">
                        <li class="media" ng-repeat="comment in comments"
                            id="{{comment.id}}">
                            <a class="pull-left" href="#">
                                <img class="media-object" src="" alt="">
                            </a>

                            <div class="media-body">
                                <p class="pull-right" ng-show="comment.updaterId == profile.id">
                                    <a href="{{$parent.createCommentLinkUrl(comment.id)}}">link</a> |
                                    <a href="" ng-click="editComment(comment.comment, comment.id)">edit</a> |
                                    <a href="" ng-click="deleteComment(comment.comment, comment.id)">delete</a>
                                </p>

                                <p class="pull-right" ng-show="comment.updaterId != profile.id">
                                    <a href="{{$parent.createCommentLinkUrl(comment.id)}}">link</a> |
                                    <a href="" ng-click="reportComment(comment.id)">report</a>
                                </p>
                                <h4 class="media-heading">
                                    {{comment.updater.userName}}
                                    <small title="{{comment.updatedAt}}">
                                        {{$parent.formatTimeAgo(comment.updatedAt, 'YYYY-MM-DDTHH:mm:ssZZ')}}
                                    </small>
                                </h4>
                                <p ng-show="$parent.editComment.id != comment.id">
                                    {{comment.comment}}
                                </p>

                                <form role="form" ng-show="$parent.editComment.id == comment.id">
                                    <div class="form-group" ng-class="{'has-error': editComment.errors.length > 0}">
                                        <textarea class="form-control"
                                                  placeholder="Add a comment / Continue the discussion"
                                                  style="width:90%" id="{{'editAnnotationComment'+comment.id}}"
                                                  ng-model="$parent.editComment.text"></textarea>
                                        <span class="help-block" ng-show="$parent.editComment.errors.length > 0"
                                              ng-repeat="error in $parent.editComment.errors">{{error}}</span>
                                    </div>
                                    <button type="submit" class="btn btn-primary" ng-click="updateComment(comment.id)">
                                        Update
                                    </button>
                                    <button type="submit" class="btn btn-default"
                                            ng-click="$parent.editComment.id = null">
                                        cancel
                                    </button>
                                </form>
                            </div>
                        </li>
                    </ul>

                </div>
            </div>
        </div>
    </div>
</div>